<div class="main-container">
    <!-- Left Sidebar (Menu) -->
    <aside class="sidebar">
        <!-- Top Section -->
        <div class="sidebar-top">
            <div class="profile-section">
                <!-- User profile or other content goes here -->
                <img src="assets/WIN_20230303_19_57_15_Pro.jpg" alt="Profile" class="profile-image">
            </div>
            <div class="clickable" (click)="onClick()">
                <div class="img-container">
                    <img src="assets/chatbubble.png" alt="chat-icon">
                </div>
            </div>
            <div class="clickable" (click)="onClick()">
                <div class="img-container">
                    <img src="assets/contact-book.png" alt="chat-icon">
                </div>
            </div>
            <div class="clickable" (click)="onClick()">
                <div class="img-container">
                    <img src="assets/checkbox.png" alt="chat-icon">
                </div>
            </div>
        </div>

        <!-- Bottom Section -->
        <div class="sidebar-bottom">
            <div class="clickable" (click)="onClick()">
                <div class="img-container">
                    <img src="assets/cloud.png" alt="chat-icon">
                </div>
            </div>
            <div class="clickable" (click)="onClick()">
                <div class="img-container">
                    <img src="assets/briefcase.png" alt="chat-icon">
                </div>
            </div>
            <div class="clickable" (click)="onClick()">
                <div class="img-container">
                    <img src="assets/settings.png" alt="chat-icon">
                </div>
            </div>
        </div>
    </aside>

    <!-- Middle Panel (Chat List) -->
    <section class="chat-list-panel">
        <div id="contact-search-grid" class="grid-setting" style="grid-template-columns: auto 32px 32px;">
            <div class="group-search-item">
                <img src="assets/search.png" alt="search-icon" class="search-container click">
                <input type="text" placeholder="Tìm kiếm" class="search-bar-input" [matAutocomplete]="users"
                    (input)="filterUsers($event)">

                <!-- Autocomplete dropdown with dynamic options -->
                <mat-autocomplete #users="matAutocomplete">
                    <mat-option *ngFor="let user of filteredUsers" [value]="user">
                        {{ user.userName }}
                    </mat-option>
                </mat-autocomplete>
            </div>
        </div>

        <mat-tab-group animationDuration="0ms" class="tabs">
            <mat-tab>
                <ng-template mat-tab-label>
                    <span class="custom-tab-label">Tất cả</span>
                </ng-template>

                <!-- Chat List (User Selection) -->
                <ul class="chat-list">
                    <li *ngFor="let user of users1" class="chat-item" (click)="selectUser(user)">
                        <div class="chat-info">
                            <p class="chat-name">{{ user.userName }}</p>
                            <p class="last-message">Bạn:...</p>
                        </div>
                        <span class="chat-time">19/10</span>
                    </li>
                </ul>
            </mat-tab>

            <mat-tab>
                <ng-template mat-tab-label>
                    <span class="custom-tab-label">Chưa đọc</span>
                </ng-template>
                Không có nội dung chưa đọc
            </mat-tab>
        </mat-tab-group>
    </section>

    <!-- Right Panel (Main Content) -->
    <main class="content">
        <!-- Default Message When No Conversation is Selected -->
        <div *ngIf="!selectedUser" class="welcome-page">
            <img src="assets/Logo_Zalo.png" alt="Welcome Image" class="welcome-image">
            <h2>Chào mừng đến với Zalo PC!</h2>
            <p>Khám phá những tiện ích hỗ trợ làm việc và trò chuyện cùng<br>
                người thân, bạn bè được tối ưu hóa cho máy tính của bạn.</p>
        </div>

        <!-- Conversation Box When a User is Selected -->
        <div *ngIf="selectedUser">
            <div class="conversation-header">
                <div class="conversation-header-left">
                    <img src="assets/letter-z.png" alt="User Avatar" class="header-avatar">
                    <span class="header-username">{{ selectedUser.userName }}</span>
                </div>
                <div class="conversation-header-right">
                    <button class="header-btn" title="Add User">
                        <img src="assets/people.png" alt="Add User">
                    </button>
                    <button class="header-btn" title="Search in Conversation">
                        <img src="assets/search.png" alt="Search">
                    </button>
                    <button class="header-btn" title="Video Call">
                        <img src="assets/camera.png" alt="Video Call">
                    </button>
                </div>
            </div>

            <!-- Conversation Messages -->
            <div class="chatting-part">
                <div *ngFor="let message of getSelectedUserConversation()" [class.you]="message.sender === 'You'"
                    class="message">
                    <strong>{{ message.sender }}:</strong> {{ message.message }}
                </div>
            </div>

            <!-- Chat Input Features -->
            <div class="features-part">
                <button class="feature-btn" title="Stickers">
                    <img src="assets/sticker (1).png" alt="Stickers">
                </button>
                <button class="feature-btn" title="Send Image">
                    <img src="assets/image.png" alt="Send Image">
                </button>
                <button class="feature-btn" title="Send File">
                    <img src="assets/attach.png" alt="Send File">
                </button>
            </div>

            <!-- Typing Input -->
            <div class="typing-part">
                <input type="text" placeholder="Nhập tin nhắn ở đây..." class="message-input" [(ngModel)]="messageText"
                    (keyup)="$event.keyCode === 13 && sendMessage()">
                <button class="icon-btn">
                    <img src="assets/smile.png" alt="Select Icon">
                </button>
                <button class="like-btn">
                    <img src="assets/like.png" alt="Like">
                </button>
            </div>
        </div>
    </main>
</div>